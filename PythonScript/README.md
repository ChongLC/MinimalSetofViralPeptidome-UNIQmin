[To the main README >](https://github.com/ChongLC/MinimalSetofViralPeptidome-UNIQmin/blob/master/README.md)

# **Step-by-step of UNIQmin**

Table of Contents
====================
- [Getting Started](#getting-started)
- [Quick Start](#quick-start)
    + [Step 1: Generation of overlapping *k*-mers](#step-1---generation-of-overlapping-k-mers)
    + [Step 2: Frequency grouping of the generated overlapping *k*-mers](#step-2---frequency-grouping-of-the-generated-overlapping-k-mers)
    + [Step 3: Identification of a pre-qualified minimal set of sequences](#step-3---identification-of-a-pre-qualified-minimal-set-of-sequences)
    + [Step 4: Omission of all *k*-mers cognate to the pre-qualified minimal set](#step-4---omission-of-all-k-mers-cognate-to-the-pre-qualified-minimal-set)
    + [Step 5: Identification of the final minimal set of sequences](#step-5---identification-of-the-final-minimal-set-of-sequences)
- [Figure Summary](#figure-summary)

---
## Getting Started
Download this specific folder `PythonScript` to retrieve all the python scripts 
```
svn export https://github.com/ChongLC/MinimalSetofViralPeptidome-UNIQmin/trunk/PythonScript
```
**Note**: (if svn is not yet installed)
```
sudo apt-get install subversion
```

## Quick Start
As with any typical tool, an input file would be required to generate the output, as per the user-defined parameters. The input for UNIQmin should be a file containing a set of non-redundant (nr) sequences in the FASTA format. Sequences containing the unknown residue, X, may be removed, if desired. Keeping them may result in a minimal set comprising of sequences with the unknown residue.

Usage: 
```
pythonscript.py [-h] [-i INPUT] [-o OUTPUT] [-k [KMERLENGTH]] [-t THREADS]

optional arguments:
  -h, --help            show this help message and exit
  -i INPUT, --input INPUT
                        Path of the input file (in FASTA format)
  -o OUTPUT, --output OUTPUT
                        Path of the output file to be created
  -k [KMERLENGTH], --kmer [KMERLENGTH]
                        The length of k-mers to be used
  -t THREADS, --thread THREADS
                        The number of threads to be used
```

Below we describe the algorithmic steps of the tool using a sample input file: 

#### Step 1 - Generation of overlapping k-mers
Use the sample non-redundant (nr) input file (*e.g.* exampleinputfile.fas; referred to as *A*) to generate a set of defined overlapping *k*-mers (*e.g.* 9-mers; other *k*-mers length can also be defined) from each of the sequences in the input file (the *k*-mer set will be referred to as *B'*), by employing the "U1_KmerGenerator" script. The nr input file is achieved through the removal of peptidome redundant sequences, which can be generated by use of the tool [CD-HIT](http://weizhongli-lab.org/cd-hit/) or [MMSeqs2](https://github.com/soedinglab/MMseqs2). In a given dataset, peptidome redundant sequences are those with an individual repertoire of defined *k*-mers, which can be collectively represented by two or more of the other sequences in the dataset.  <br>
- Command: 
    ```
    python3 U1_KmerGenerator.py -i exampleinput.fas -o result -t 4
    ```

#### Step 2 - Frequency grouping of the generated overlapping k-mers
Categorise the overlapping *k*-mers (file *B'*) according to the occurrence (frequency) count

i) All single occurring *k*-mer peptides are deposited into a file (referred to as *B'1*) by use of the "U2.1_Singletons" script. <br>
- Command: 
    ```
    python3 U2.1_Singletons.py -o result
    ```

ii) All multi-occurring *k*-mer peptides are deposited into a file (referred to as *B'2*) by use of the "U2.2_Multitons" script. <br>
- Command: 
    ```
    python3 U2.2_Multitons.py -o result
    ```

#### Step 3 - Identification of a pre-qualified minimal set of sequences
i) Match all the single occurring *k*-mer peptides of *B'1* and all sequences of *A* to identify the sequences that captured each of the *k*-mer peptides, and such sequences of *A* are then subsequently deposited into a minimal set file, *Z*. This step is carried out by use of the "U3.1_PreQualifiedMinSet" script. <br>
- Command: 
    ```
    python3 U3.1_PreQualifiedMinSet.py -i exampleinput.fas -o result
    ```

ii) Remove the sequences deposited into *Z* from file *A*, and thus, resulting in a new file, containing only the remaining sequences, referred to as *A#*. This step is carried out by use of the "U3.2_UnmatchedSingletons" script. <br>
- Command: 
    ```
    python3 U3.2_UnmatchedSingletons.py -i exampleinput.fas -o result
    ```

#### Step 4 - Omission of all k-mers cognate to the pre-qualified minimal set
i) Remove the duplicates among the multi-occurring *k*-mer peptides in file *B'2*, which would result in a file comprising only a single copy of the multi-occurring *k*-mer peptides. This step is carried out by use of the "U4.1_Non-SingletonsDedup" script. <br>
- Command: 
    ```
    python3 U4.1_Non-SingletonsDedup.py -o result
    ```

ii) Identify the unique, multi-occurring *k*-mers that matched the pre-qualified minimal set of sequences in *Z*. This step is carried out by use of the "U4.2_Multi-OccurringPreMinSet" script. <br>
- Command: 
    ```
    python3 U4.2_Multi-OccurringPreMinSet.py -o result
    ```

iii) Remove the matched unique, multi-occurring *k*-mer peptides, which would result in a new file (referred to as *B#*). This step is carried out by use of the "U4.3_UnmatchedMulti-Occurring" script. <br>
- Command: 
    ```
    python3 U4.3_UnmatchedMulti-Occurring.py -o result
    ```

#### Step 5 - Identification of the final minimal set of sequences
Match between the remaining unique, multi-occurring *k*-mers of *B#* and the remaining sequence of *A#*, and subsequently, identify the sequence with the maximal *k*-mers coverage, which is then deposited into the earlier defined file *Z* (minimal set). The deposited sequences in file *Z* and its inherent *k*-mers are removed from file *A#* and file *B#*, respectively. This process is repeated until the *k*-mers in the file *B#* are exhausted. This step is carried out by use of the "U5.1_RemainingMinSet" and "U5.2_MinSet" scripts. The output of the sample input file (exampleinput.fas) is provided as an example (exampleoutput.fasta). <br>
- Command: 
    ```
    python3 U5.1_RemainingMinSet.py -o result -t 2
    python3 U5.2_MinSet.py -i exampleinput.fas -o result
    ```

[To the main README >](https://github.com/ChongLC/MinimalSetofViralPeptidome-UNIQmin/blob/master/README.md)

---
## Figure Summary
<img src="Summary.png" width="640" height="1075">
